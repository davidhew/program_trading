1.pandas需要的一些计算库，最多只支持python 3.12；不能支持3.14

#扫描项目代码，安装依赖包
pip install pipreqs
pipreqs ./ --encoding=utf8 --force --ignore .venv

#会将最全面的依赖库信息写入到requirements.txt里
pip freeze > requirements.txt
pip install --upgrade pip  # 先升级 pip 自身，确保支持 3.12 的最新特性
pip install -r requirements.txt



# 允许 docker 网桥流量转发
iptables -I FORWARD -i docker0 -j ACCEPT
iptables -I FORWARD -o docker0 -j ACCEPT

# 强制对 docker 网段进行 NAT 伪装
# 注意：如果你的 docker 网段不是 172.17.0.0，请修改
iptables -t nat -I POSTROUTING -s 172.17.0.0/16 -j MASQUERADE

#停止并删除容器
docker stop stock_analyzer
docker rm stock_analyzer

#构建&运行容器
# 1. 强制重新构建镜像（这步会下载依赖，但只执行一次）
docker-compose build

# 2. 启动容器
docker-compose up -d

#在mac端为python项目下载基于x86架构依赖的所有python包到本地
pip download -r requirements.txt \
    -d ./packages \
    --platform manylinux2014_x86_64 \
    --only-binary=:all: \
    --python-version 312



#排查问题相关

#查看实时日志
docker logs -f stock_analyzer

|----修改了什么？------------|是否需要 Build？|---------	原因-------------------------|
| Python 代码 (.py 文件)    |	   否      |因为有 volumes 挂载，容器直接读取宿主机文件。  |
|依赖清单 (requirements.txt)|	   是	   |    必须重新安装新包并打包进镜像层。          |
|    Dockerfile本身        |	       是	   |    镜像的构建逻辑发生了变化。               |
|环境变量(Compose里的environment)|	否	   | 只要up -d 重启容器,Compose会自动注入新变量。 |